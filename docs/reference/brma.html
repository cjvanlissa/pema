<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function uses Bayesian estimation via the stan function
rstan::sampling to fit a meta-analytic mixed-effects model with
moderators. A lasso or horseshoe prior is used to shrink the regression
coefficients of irrrelevant moderators towards zero. See Details."><title>Conduct Bayesian Regularized Meta-Analysis — brma • pema</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conduct Bayesian Regularized Meta-Analysis — brma"><meta property="og:description" content="This function uses Bayesian estimation via the stan function
rstan::sampling to fit a meta-analytic mixed-effects model with
moderators. A lasso or horseshoe prior is used to shrink the regression
coefficients of irrrelevant moderators towards zero. See Details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pema</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cjvanlissa/pema/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Conduct Bayesian Regularized Meta-Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/pema/blob/HEAD/R/brma.R" class="external-link"><code>R/brma.R</code></a></small>
      <div class="d-none name"><code>brma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses Bayesian estimation via the <code>stan</code> function
rstan::sampling to fit a meta-analytic mixed-effects model with
moderators. A lasso or horseshoe prior is used to shrink the regression
coefficients of irrrelevant moderators towards zero. See Details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">brma</span><span class="op">(</span>
  <span class="va">formula</span>,
  <span class="va">data</span>,
  vi <span class="op">=</span> <span class="st">"vi"</span>,
  study <span class="op">=</span> <span class="cn">NULL</span>,
  method <span class="op">=</span> <span class="st">"hs"</span>,
  standardize <span class="op">=</span> <span class="cn">TRUE</span>,
  prior <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>, lasso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, hs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">1</span>, df_global <span class="op">=</span> <span class="fl">1</span>,
    df_slab <span class="op">=</span> <span class="fl">4</span>, scale_global <span class="op">=</span> <span class="fl">1</span>, scale_slab <span class="op">=</span> <span class="fl">1</span>, par_ratio <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>,
  mute_stan <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>An object of class <code>formula</code> (or one that can be coerced to
that class), see <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p></dd>
<dt>data</dt>
<dd><p>Optional data.frame containing the variables in the model, see
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p></dd>
<dt>vi</dt>
<dd><p>Character. Name of the column in the <code>data</code> that
contains the variances of the effect sizes. This column will be removed from
the data prior to analysis. Defaults to <code>"vi"</code>.</p></dd>
<dt>study</dt>
<dd><p>Character. Name of the column in the
<code>data</code> that contains the study id. Use this when the data includes
multiple effect sizes per study. This column can be a vector of integers, or
a factor. This column will be removed from the data prior to analysis.
See <code>Details</code> for more information about analyzing dependent data.</p></dd>
<dt>method</dt>
<dd><p>Character, indicating the type of regularizing prior to use.
Supports one of <code>c("lasso", "hs")</code>, see Details. Defaults to
<code>"lasso"</code>.</p></dd>
<dt>standardize</dt>
<dd><p>Logical, indicating whether or not to standardize the
predictors (defaults to <code>TRUE</code>, which is recommended so that shrinking
affects all parameters similarly.</p></dd>
<dt>prior</dt>
<dd><p>Numeric vector, specifying the prior to use. Note that the
different <code>method</code>s require this vector to contain specific named
elements.</p></dd>
<dt>mute_stan</dt>
<dd><p>Logical, indicating whether mute all 'Stan' output or not.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed on to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code>.
Use this, e.g., to override default arguments of that function.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Penalization of the regression coefficients occurs either via the
lasso (Park &amp; Casella, 2008) or the regularized horseshoe
(Piironen &amp; Vehtari, 2017) prior.</p><dl><dt>lasso</dt>
<dd><p>The Bayesian equivalent of the lasso penalty is obtained when
placing independent Laplace (i.e., double exponential) priors on the
regression coefficients centered around zero. The scale of the Laplace
priors is determined by a global scale parameter <code>scale</code>, which
defaults to 1 and an inverse-tuning parameter \(\frac{1}{\lambda}\)
which is given a chi-square prior governed by a degrees of freedom
parameter <code>df</code> (defaults to 1). If <code>standardize = TRUE</code>,
shrinkage will
affect all coefficients equally and it is not necessary to adapt the
<code>scale</code> parameter. Increasing the <code>df</code> parameter will allow
larger values for the inverse-tuning parameter, leading to less shrinkage.</p></dd>

<dt>hs</dt>
<dd><p>One issue with the lasso prior is that it has relatively light
tails. As a result, not only does the lasso have the desirable behavior of
pulling small coefficients to zero, it also results in too much shrinkage
of large coefficients. An alternative prior that improves upon this
shrinkage pattern is the horseshoe prior (Carvalho, Polson &amp; Scott, 2010).
The horseshoe prior has an infinitely large spike at zero, thereby pulling
small coefficients toward zero but in addition has fat tails, which allow
substantial coefficients to escape the shrinkage. The regularized horseshoe
is an extension of the horseshoe prior that allows the inclusion of prior
information regarding the number of relevant predictors and can
be more numerically stable in certain cases (Piironen &amp; Vehtari, 2017).
The regularized horseshoe has a global shrinkage parameter that influences
all coefficients similarly and local shrinkage parameters that enable
flexible shrinkage patterns for each coefficient separately. The local
shrinkage parameters are given a Student's t prior with a default <code>df</code>
parameter of 1. Larger values for <code>df</code> result in lighter tails and
a prior that is no longer strictly a horseshoe prior. However, increasing
<code>df</code> slightly might be necessary to avoid divergent transitions in
Stan (see also <a href="https://mc-stan.org/misc/warnings.html" class="external-link">https://mc-stan.org/misc/warnings.html</a>). Similarly,
the degrees of freedom for the Student's t prior on the global shrinkage
parameter <code>df_global</code> can be increased from the default of 1 to, for
example, 3 if divergent transitions occur although the resulting
prior is then strictly no longer a horseshoe. The scale for the Student's t
prior on the global shrinkage parameter <code>scale_global</code> defaults to 1
and can be decreased to achieve more shrinkage. Moreover, if prior
information regarding the number of relevant moderators is available, it is
recommended to include this information via the <code>par_ratio</code> argument
by setting it to the ratio of the expected number of non-zero coefficients
to the expected number of zero coefficients. When <code>par_ratio</code> is
specified, <code>scale_global</code> is ignored and instead based on the
available prior information. Contrary to the horseshoe prior, the
regularized horseshoe applies additional regularization on large
coefficients which is governed by a Student's t prior with a
<code>scale_slab</code> defaulting to 2 and <code>df_slab</code> defaulting to 4.
This additional regularization ensures at least some shrinkage of large
coefficients to avoid any sampling problems.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Park, T., &amp; Casella, G. (2008). The Bayesian Lasso. Journal of the American
Statistical Association, 103(482), 681–686. doi:10.1198/016214508000000337</p>
<p>Carvalho, C. M., Polson, N. G., &amp; Scott, J. G. (2010). The horseshoe estimator
for sparse signals. Biometrika, 97(2), 465–480. doi:10.1093/biomet/asq017</p>
<p>Piironen, J., &amp; Vehtari, A. (2017). Sparsity information and regularization in
the horseshoe and other shrinkage priors. Electronic Journal of Statistics, 11(2).
doi:10.1214/17-ejs1337si</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"curry"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">curry</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">50</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"vi"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span>, <span class="st">"donorcode"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">brma</span><span class="op">(</span><span class="va">d</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">df</span>, iter <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Caspar J van Lissa, Sara J van Erp.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

